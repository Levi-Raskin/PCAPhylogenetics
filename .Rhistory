library(ape)
library(ggplot2)
library(ggtree)
library(phangorn)
library(phytools)
setwd("/Users/levir/Documents/GitHub/PCAPhylogenetics")
set.seed(5)
rSPRFunc <- function(tree1, tree2){
treelist <- list(tree1, tree2)
write.tree(treelist, paste(getwd(), "/rSPR/res.nwk", sep = ""))
res <- system(
paste(getwd(),
"/rSPR/rspr -pairwise -unrooted -no-symmetric-pairwise < ",
getwd(),
"/rSPR/res.nwk", sep = "")
, intern = T)
nums <- sub("^[^,]*,\\s*([0-9]+)\"?$", "\\1", res[[1]])
return(as.integer(nums))
}
sprMast <- function(tree1, tree2){
sprDist <- rSPRFunc(tree1, tree2)
mastSize <- Ntip(phangorn::mast(tree1, tree2))
return(sprDist/mastSize)
}
#read tree trace
# trees <- data.table::fread("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/hominin.trees",
# nThread = 10)
#burn in
# trees <- trees[round(0.1 * nrow(trees)) : nrow(trees),]
# sample 1,000 trees from the posterior distribution
# treeSubset <- trees[sample(1:nrow(trees), 1000, replace = FALSE), ]
# rm(trees)
# write.csv(treeSubset,"/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/sampledTrees.csv")
treeSubset <- read.delim("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/sampledTrees.tsv")
#convert to phylo object
phyloList <- list()
for(i in 1:nrow(treeSubset)){
phyloList[[i]] <- ape::read.tree(text = as.character(treeSubset[i, 2]))
}
simResPC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults.rds")
simRes2550PC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults25char50char.rds")
simResPC1PC2 <- c(simResPC1PC2, simRes2550PC1PC2)
for(i in 1:length(simResPC1PC2)){
if(i == 1){
concatDFPC1PC2 <- simResPC1PC2[[1]]$resMat
}else{
concatDFPC1PC2 <- rbind(concatDFPC1PC2, simResPC1PC2[[i]]$resMat)
}
}
concatDFPC1PC2$numCharacters <- as.factor(concatDFPC1PC2$numCharacters)
concatDFPC1PC2$setRate <- as.factor(concatDFPC1PC2$setRate)
concatDFPC1PC2$propConflicting <- as.factor(concatDFPC1PC2$propConflicting)
concatDFPC1PC2$varRateExpectation <- concatDFPC1PC2$variableRateShape / concatDFPC1PC2$variableRateScale
concatDFPC1PC2$varRateExpectation <- as.factor(concatDFPC1PC2$varRateExpectation)
#num trees identical
sum(concatDFPC1PC2$RF == 0) / nrow(concatDFPC1PC2)
summary(concatDFPC1PC2$RF)
simResAll <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResultsAllPCs.rds")
simRes2550All <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResultsAllPCs25char50char.rds")
simResAll <- c(simResAll, simRes2550All)
for(i in 1:length(simResAll)){
if(i == 1){
concatDFAll <- simResAll[[1]]$resMat
}else{
concatDFAll <- rbind(concatDFAll, simResAll[[i]]$resMat)
}
}
concatDFAll$numCharacters <- as.factor(concatDFAll$numCharacters)
concatDFAll$setRate <- as.factor(concatDFAll$setRate)
concatDFAll$propConflicting <- as.factor(concatDFAll$propConflicting)
concatDFAll$varRateExpectation <- concatDFAll$variableRateShape / concatDFAll$variableRateScale
concatDFAll$varRateExpectation <- as.factor(concatDFAll$varRateExpectation)
#num trees identical
sum(concatDFAll$RF == 0) / nrow(concatDFAll)
summary(concatDFAll$RF)
simResMahalPC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResultsMahalanobisDistancePC1PC2.rds")
simResMahalPC1PC22550 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResultsMahalanobisDistancePC1PC225char50char.rds")
simResMahalPC1PC2 <- c(simResMahalPC1PC2, simResMahalPC1PC22550)
for(i in 1:length(simResMahalPC1PC2)){
if(i == 1){
concatDFMPC12 <- simResMahalPC1PC2[[1]]$resMat
}else{
concatDFMPC12 <- rbind(concatDFMPC12, simResMahalPC1PC2[[i]]$resMat)
}
}
concatDFMPC12$numCharacters <- as.factor(concatDFMPC12$numCharacters)
concatDFMPC12$setRate <- as.factor(concatDFMPC12$setRate)
concatDFMPC12$propConflicting <- as.factor(concatDFMPC12$propConflicting)
concatDFMPC12$varRateExpectation <- concatDFMPC12$variableRateShape / concatDFMPC12$variableRateScale
concatDFMPC12$varRateExpectation <- as.factor(concatDFMPC12$varRateExpectation)
#num trees identical
sum(concatDFMPC12$RF == 0) / nrow(concatDFMPC12)
sum(concatDFMPC12$RF == 0)
summary(concatDFMPC12$SPR)
summary(concatDFMPC12$RF)
?wilcox.test
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$RF))
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$RF, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$RF)$p.value))
print("------------------------------")
}
}
#are the distributions sig. different between set rate and varrate expectation across numcharacters
nc <- unique(concatDFPC1PC2$numCharacters)
rate <- c(0.1, 1, 10)
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$RF))
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$RF, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$RF)$p.value))
print("------------------------------")
}
}
concatDFPC1PC2
simResPC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults.rds")
simRes2550PC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults25char50char.rds")
simResPC1PC2 <- c(simResPC1PC2, simRes2550PC1PC2)
for(i in 1:length(simResPC1PC2)){
if(i == 1){
concatDFPC1PC2 <- simResPC1PC2[[1]]$resMat
}else{
concatDFPC1PC2 <- rbind(concatDFPC1PC2, simResPC1PC2[[i]]$resMat)
}
}
concatDFPC1PC2$numCharacters <- as.factor(concatDFPC1PC2$numCharacters)
concatDFPC1PC2$setRate <- as.factor(concatDFPC1PC2$setRate)
concatDFPC1PC2$propConflicting <- as.factor(concatDFPC1PC2$propConflicting)
concatDFPC1PC2$varRateExpectation <- concatDFPC1PC2$variableRateShape / concatDFPC1PC2$variableRateScale
concatDFPC1PC2$varRateExpectation <- as.factor(concatDFPC1PC2$varRateExpectation)
#num trees identical
sum(concatDFPC1PC2$RF == 0) / nrow(concatDFPC1PC2)
summary(concatDFPC1PC2$RF)
#are the distributions sig. different between set rate and varrate expectation across numcharacters
nc <- unique(concatDFPC1PC2$numCharacters)
rate <- c(0.1, 1, 10)
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$RF))
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$RF, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$RF)$p.value))
print("------------------------------")
}
}
head(concatDFPC1PC2)
library(dplyr)
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$RF))
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$RF, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$RF)$p.value))
print("------------------------------")
}
}
nc <- unique(concatDFAll$numCharacters)
rate <- c(0.1, 1, 10)
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFAll, numCharacters == c, setRate == r)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFAll, numCharacters == c, varRateExpectation == r)$RF))
print(paste("p =", wilcox.test(filter(concatDFAll, numCharacters == c, setRate == r)$RF, filter(concatDFAll, numCharacters == c, varRateExpectation == r)$RF)$p.value))
print("------------------------------")
}
}
#are the distributions sig. different between set rate and varrate expectation across numcharacters
nc <- unique(concatDFPC1PC2$numCharacters)
varRatesLG <- TRUE
rate <- c(0.1, 1, 10)
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$RF))
if(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$RF) < mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$RF, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF)$p.value))
print("------------------------------")
}
}
varRatesLG
nc <- unique(concatDFAll$numCharacters)
rate <- c(0.1, 1, 10)
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFAll, numCharacters == c, setRate == r)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFAll, numCharacters == c, varRateExpectation == r)$RF))
if(mean(filter(concatDFAll, numCharacters == c, varRateExpectation == r)$RF) < mean(filter(concatDFAll, numCharacters == c, setRate == r, propConflicting ==0)$RF)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFAll, numCharacters == c, setRate == r, propConflicting ==0)$RF, filter(concatDFAll, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF)$p.value))
print("------------------------------")
}
}
varRatesLG
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$SPR))
if(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$SPR) < mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$SPR, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR)$p.value))
print("------------------------------")
}
}
#are the distributions sig. different between set rate and varrate expectation across numcharacters
nc <- unique(concatDFPC1PC2$numCharacters)
varRatesLG <- TRUE
rate <- c(0.1, 1, 10)
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$SPR))
if(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$SPR) < mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$SPR, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR)$p.value))
print("------------------------------")
}
}
varRatesLG
nc <- unique(concatDFAll$numCharacters)
rate <- c(0.1, 1, 10)
varRatesLG <- TRUE
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFAll, numCharacters == c, setRate == r)$SPR))
print("Mean for var rate: ")
print(mean(filter(concatDFAll, numCharacters == c, varRateExpectation == r)$SPR))
if(mean(filter(concatDFAll, numCharacters == c, varRateExpectation == r)$SPR) < mean(filter(concatDFAll, numCharacters == c, setRate == r, propConflicting ==0)$SPR)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFAll, numCharacters == c, setRate == r, propConflicting ==0)$SPR, filter(concatDFAll, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR)$p.value))
print("------------------------------")
}
}
varRatesLG
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$SPR))
if(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$SPR) < mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR)){
varRatesLG <- FALSE
}
meanDiff <- c(meanDiff, mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$SPR) - mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR))
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$SPR, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR)$p.value))
print("------------------------------")
}
}
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$SPR))
if(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r)$SPR) < mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r)$SPR, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR)$p.value))
print("------------------------------")
}
}
