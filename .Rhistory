p = 2
expected = psi / (dof - p - 1)
#Expected mean:
psi =  rbind(c(1,	1e-06),
c(1e-06,	1))
dof = 52
p = 2
expected = psi / (dof - p - 1)
View(expected)
library(ape)
tree <- read.tree(text = ""(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);"")
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
library(TreeTools)
nodelabels()
x <- AddTip(tree, 13)
plot(x)
x <- AddTip(tree, 13, lengthBelow = 6, label = "Sahelanthropus")
plot(x)
x <- AddTip(tree, 13, lengthBelow = 5, label = "Sahelanthropus")
plot(x)
write.tree(x)
?AddTip
edgelabels()
tree$edge.length
tree$edge.length[9]
tree$edge.length[10]
x <- AddTip(tree, 13, edgeLength = 1, lengthBelow = 5 - 0.568721, label = "Sahelanthropus")
plot(x)
write.tree(x)
library(ape)
library(TreeTools)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
x <- AddTip(tree, 13, edgeLength = 1, lengthBelow = 5 - 0.568721, label = "Sahelanthropus")
plot(x)
write.tree(x)
plot(tree)
nodelabels()
tree$edge
tree$edge.length
tree$tip.label
tiplabels()
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
x <- AddTip(tree, 13, edgeLength = 1, lengthBelow = 5 - 0.568721, label = "Sahelanthropus")
plot(x)
write.tree(x)
x <- AddTip(tree, 14, edgeLength = 1, lengthBelow = 5 - 2.333553, label = "Sahelanthropus")
plot(x)
write.tree(x)
plot(tree)
tree <- read.newick(text = "(((((((((((((((Paranthropus_boisei,Paranthropus_robustus),Paranthropus_aethiopicus),((((Homo_sapiens,Homo_ergaster),Homo_habilis),Homo_rudolfensis),Kenyanthropus_platyops)),Australopithecus_africanus),Australopithecus_garhi),Australopithecus_afarensis),Australopithecus_anamensis),Ardipithecus_ramidus),Sahelanthropus_tchadensis),Pan_troglodytes),Gorilla_gorilla),Pongo_pygmaeus),Hylobates),Papio),Colobus);")
plot(tree)
tree <- read.tree(text = "(((((((((((((((Paranthropus_boisei,Paranthropus_robustus),Paranthropus_aethiopicus),((((Homo_sapiens,Homo_ergaster),Homo_habilis),Homo_rudolfensis),Kenyanthropus_platyops)),Australopithecus_africanus),Australopithecus_garhi),Australopithecus_afarensis),Australopithecus_anamensis),Ardipithecus_ramidus),Sahelanthropus_tchadensis),Pan_troglodytes),Gorilla_gorilla),Pongo_pygmaeus),Hylobates),Papio),Colobus);")
plot(tree)
drop.tip("Sahelanthropus_tchadensis")
drop.tip(tree, "Sahelanthropus_tchadensis")
plot(tree)
tree <- read.tree(text = "(((((((((((((((Paranthropus_boisei,Paranthropus_robustus),Paranthropus_aethiopicus),((((Homo_sapiens,Homo_ergaster),Homo_habilis),Homo_rudolfensis),Kenyanthropus_platyops)),Australopithecus_africanus),Australopithecus_garhi),Australopithecus_afarensis),Australopithecus_anamensis),Ardipithecus_ramidus),Sahelanthropus_tchadensis),Pan_troglodytes),Gorilla_gorilla),Pongo_pygmaeus),Hylobates),Papio),Colobus);")
tree <- drop.tip(tree, "Sahelanthropus_tchadensis")
plot(tree)
nodelabels()
tiplabels()
nodeIdx <- which(tree$edge[, 2] == 13)
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- read.tree(text = "(((((((Ardipithecus_ramidus:0.113378,(((Australopithecus_afarensis:0.201238,(((Australopithecus_sediba:0.089062,((Homo_sapiens:0.151667,Homo_ergaster:0.039736):0.253305,Homo_habilis:0.100855):0.289318):0.092968,((Homo_rudolfensis:0.252625,Australopithecus_africanus:0.248673):0.07503,Kenyanthropus_platyops:0.042158):0.021153):0.141378,(((Paranthropus_boisei:0.176221,Paranthropus_robustus:0.374093):0.249827,Paranthropus_aethiopicus:0.012404):0.709147,Australopithecus_garhi:0.090699):0.063379):0.278037):0.069718,Australopithecus_anamensis:0.103691):0.029926,Sahelanthropus_tchadensis:0.295334):0.110187):0.190976,Pan_troglodytes:0.074008):0.102138,Gorilla_gorilla:0.10163):0.206075,Pongo_pygmaeus:0.393339):0.193813,Papio:0.01956):0.195913,Hylobates:0.209641):0,Colobus_guereza:0.07256);")
plot(tree)
tree <- read.tree(text = tree <- read.tree(text = "(((((((Ardipithecus_ramidus:0.08,(((Australopithecus_afarensis:0.14,(((Australopithecus_sediba:0.06,((Homo_sapiens:0.30,Homo_ergaster:0.30):0.05,Homo_habilis:0.25):0.05):0.06,((Homo_rudolfensis:0.10,Australopithecus_africanus:0.10):0.05,Kenyanthropus_platyops:0.05):0.02):0.08,(((Paranthropus_boisei:0.08,Paranthropus_robustus:0.08):0.05,Paranthropus_aethiopicus:0.05):0.10,Australopithecus_garhi:0.08):0.06):0.10):0.05,Australopithecus_anamensis:0.08):0.05,Sahelanthropus_tchadensis:0.10):0.10):0.15,Pan_troglodytes:0.40):0.10,Gorilla_gorilla:0.40):0.15,Pongo_pygmaeus:0.40):0.15,Papio:0.40):0.10,Hylobates:0.40):0,Colobus_guereza:0.40);"))
tree <- drop.tip(tree, "Sahelanthropus_tchadensis")
plot(tree)
tree <- read.tree(text = tree <- read.tree(text = "(((((((Ardipithecus_ramidus:0.08,(((Australopithecus_afarensis:0.14,(((Australopithecus_sediba:0.06,((Homo_sapiens:0.30,Homo_ergaster:0.30):0.05,Homo_habilis:0.25):0.05):0.06,((Homo_rudolfensis:0.10,Australopithecus_africanus:0.10):0.05,Kenyanthropus_platyops:0.05):0.02):0.08,(((Paranthropus_boisei:0.08,Paranthropus_robustus:0.08):0.05,Paranthropus_aethiopicus:0.05):0.10,Australopithecus_garhi:0.08):0.06):0.10):0.05,Australopithecus_anamensis:0.08):0.05,Sahelanthropus_tchadensis:0.10):0.10):0.15,Pan_troglodytes:0.40):0.10,Gorilla_gorilla:0.40):0.15,Pongo_pygmaeus:0.40):0.15,Papio:0.40):0.10,Hylobates:0.40):0,Colobus_guereza:0.40);")
)
tree <- read.tree(text = "(((((((Ardipithecus_ramidus:0.08,(((Australopithecus_afarensis:0.14,(((Australopithecus_sediba:0.06,((Homo_sapiens:0.30,Homo_ergaster:0.30):0.05,Homo_habilis:0.25):0.05):0.06,((Homo_rudolfensis:0.10,Australopithecus_africanus:0.10):0.05,Kenyanthropus_platyops:0.05):0.02):0.08,(((Paranthropus_boisei:0.08,Paranthropus_robustus:0.08):0.05,Paranthropus_aethiopicus:0.05):0.10,Australopithecus_garhi:0.08):0.06):0.10):0.05,Australopithecus_anamensis:0.08):0.05,Sahelanthropus_tchadensis:0.10):0.10):0.15,Pan_troglodytes:0.40):0.10,Gorilla_gorilla:0.40):0.15,Pongo_pygmaeus:0.40):0.15,Papio:0.40):0.10,Hylobates:0.40):0,Colobus_guereza:0.40);")
tree <- drop.tip(tree, "Sahelanthropus_tchadensis")
plot(tree)
tree <- read.tree(text = "(((((((Ardipithecus_ramidus:0.113378,(((Australopithecus_afarensis:0.201238,(((Australopithecus_sediba:0.089062,((Homo_sapiens:0.151667,Homo_ergaster:0.039736):0.253305,Homo_habilis:0.100855):0.289318):0.092968,((Homo_rudolfensis:0.252625,Australopithecus_africanus:0.248673):0.07503,Kenyanthropus_platyops:0.042158):0.021153):0.141378,(((Paranthropus_boisei:0.176221,Paranthropus_robustus:0.374093):0.249827,Paranthropus_aethiopicus:0.012404):0.709147,Australopithecus_garhi:0.090699):0.063379):0.278037):0.069718,Australopithecus_anamensis:0.103691):0.029926,Sahelanthropus_tchadensis:0.295334):0.110187):0.190976,Pan_troglodytes:0.074008):0.102138,Gorilla_gorilla:0.10163):0.206075,Pongo_pygmaeus:0.393339):0.193813,Papio:0.01956):0.195913,Hylobates:0.209641):0,Colobus_guereza:0.07256);")
# Define which taxa are extant
extant <- c("Homo_sapiens", "Pan_troglodytes", "Gorilla_gorilla",
"Pongo_pygmaeus", "Papio", "Hylobates", "Colobus_guereza")
# Compute node depths (distance from root to each tip)
depths <- node.depth.edgelength(tree)
# Find the maximum depth among extant taxa
max_depth_extant <- max(depths[tree$tip.label %in% extant])
# For each tip, compute how much needs to be added to make all extant end at the same time
to_add <- max_depth_extant - depths[tree$tip.label]
# Add that amount to branch lengths of extant taxa only
for (i in seq_along(tree$tip.label)) {
if (tree$tip.label[i] %in% extant) {
parent_edge <- which(tree$edge[,2] == i)
tree$edge.length[parent_edge] <- tree$edge.length[parent_edge] + to_add[i]
}
}
# Check: all extant taxa now end at the same time
depths2 <- node.depth.edgelength(tree)
# Read your original tree
tree <- read.tree(text = "(((((((Ardipithecus_ramidus:0.113378,(((Australopithecus_afarensis:0.201238,(((Australopithecus_sediba:0.089062,((Homo_sapiens:0.151667,Homo_ergaster:0.039736):0.253305,Homo_habilis:0.100855):0.289318):0.092968,((Homo_rudolfensis:0.252625,Australopithecus_africanus:0.248673):0.07503,Kenyanthropus_platyops:0.042158):0.021153):0.141378,(((Paranthropus_boisei:0.176221,Paranthropus_robustus:0.374093):0.249827,Paranthropus_aethiopicus:0.012404):0.709147,Australopithecus_garhi:0.090699):0.063379):0.278037):0.069718,Australopithecus_anamensis:0.103691):0.029926,Sahelanthropus_tchadensis:0.295334):0.110187):0.190976,Pan_troglodytes:0.074008):0.102138,Gorilla_gorilla:0.10163):0.206075,Pongo_pygmaeus:0.393339):0.193813,Papio:0.01956):0.195913,Hylobates:0.209641):0,Colobus_guereza:0.07256);")
# Define which taxa are extant
extant <- c("Homo_sapiens", "Pan_troglodytes", "Gorilla_gorilla",
"Pongo_pygmaeus", "Papio", "Hylobates", "Colobus_guereza")
# Compute node depths (distance from root to each tip)
depths <- node.depth.edgelength(tree)
# Find the maximum depth among extant taxa
max_depth_extant <- max(depths[tree$tip.label %in% extant])
# For each tip, compute how much needs to be added to make all extant end at the same time
to_add <- max_depth_extant - depths[tree$tip.label]
# Add that amount to branch lengths of extant taxa only
for (i in seq_along(tree$tip.label)) {
if (tree$tip.label[i] %in% extant) {
parent_edge <- which(tree$edge[,2] == i)
tree$edge.length[parent_edge] <- tree$edge.length[parent_edge] + to_add[i]
}
}
# Check: all extant taxa now end at the same time
depths2 <- node.depth.edgelength(tree)
print(depths2[tree$tip.label %in% extant])
# Optional: plot tree
plot(tree, cex=0.5)
tree <- read.tree(text = "(((((((((((((((Paranthropus_boisei,Paranthropus_robustus),Paranthropus_aethiopicus),((((Homo_sapiens,Homo_ergaster),Homo_habilis),Homo_rudolfensis),Kenyanthropus_platyops)),Australopithecus_africanus),Australopithecus_garhi),Australopithecus_afarensis),Australopithecus_anamensis),Ardipithecus_ramidus),Sahelanthropus_tchadensis),Pan_troglodytes),Gorilla_gorilla),Pongo_pygmaeus),Hylobates),Papio),Colobus);")
tree <- drop.tip(tree, "Sahelanthropus_tchadensis")
plot(tree)
tree <- read.tree(text = "(((((((Ardipithecus_ramidus:0.113378,(((Australopithecus_afarensis:0.201238,(((Australopithecus_sediba:0.089062,((Homo_sapiens:0.151667,Homo_ergaster:0.039736):0.253305,Homo_habilis:0.100855):0.289318):0.092968,((Homo_rudolfensis:0.252625,Australopithecus_africanus:0.248673):0.07503,Kenyanthropus_platyops:0.042158):0.021153):0.141378,(((Paranthropus_boisei:0.176221,Paranthropus_robustus:0.374093):0.249827,Paranthropus_aethiopicus:0.012404):0.709147,Australopithecus_garhi:0.090699):0.063379):0.278037):0.069718,Australopithecus_anamensis:0.103691):0.029926,Sahelanthropus_tchadensis:0.295334):0.110187):0.190976,Pan_troglodytes:0.074008):0.102138,Gorilla_gorilla:0.10163):0.206075,Pongo_pygmaeus:0.393339):0.193813,Papio:0.01956):0.195913,Hylobates:0.209641):0,Colobus_guereza:0.07256);")
tree <- drop.tip(tree, "Sahelanthropus_tchadensis")
plot(tree)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
nodelabels()
for(i in 1:10){
nodeIdx <- which(tree$edge[, 2] == 13)
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, 26, edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
}
branch_length
nodeIdx <- which(tree$edge[, 2] == 13)
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, 26, edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
0.8 * branch_length\
0.8 * branch_length
for(i in 1:10){
nodeIdx <- which(tree$edge[, 2] == 13)
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, 13, edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
}
plot(tree)
?MRCA
tiplabels()
MRCA(3, 4)
getMRCA(tree, "Homo_sapiens", "Neanderthal")
?getMRCA
getMRCA(tree, c("Homo_sapiens", "Neanderthal") )
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
for(i in 1:10){
nodeIdx <- which(tree$edge[, 2] == 13)
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
}
plot(tree)
nodeIdx <- which(tree$edge[, 2] == 13)
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
plot(tree)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
nodeIdx <- which(tree$edge[, 2] == 13)
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
tree
plot(tree)
nodeIdx <- which(tree$edge[, 2] == 13)
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
plot(tree)
nodeIdx <- which(tree$edge[, 2] == 13)
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
plot(tree)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
for(i in 1:10){
nodeIdx <- which(tree$edge[, 2] == getMRCA(tree, c("Homo_sapiens", "Neanderthal") ))
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
}
plot(tree)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
for(i in 1:5){
nodeIdx <- which(tree$edge[, 2] == getMRCA(tree, c("Homo_sapiens", "Neanderthal") ))
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
}
plot(tree)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
for(i in 1:5){
nodeIdx <- which(tree$edge[, 2] == getMRCA(tree, c("Homo_sapiens", "Neanderthal") ))
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
}
plot(tree)
tiplabels()
nodelabels()
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 5 - 0.568721, label = "Sahelanthropus")
plot(x)
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 0.1, label = "Sahelanthropus")
plot(x)
write.tree(x)
x <- AddTip(tree, 14, edgeLength = 1, lengthBelow = 5 - 2.333553, label = "Sahelanthropus")
plot(x)
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 5 - 2.333553, label = "Sahelanthropus")
plot(x)
plot(tree)
nodelabels()
x <- AddTip(tree, 24, edgeLength = 1, lengthBelow = 5 - 2.333553, label = "Sahelanthropus")
plot(x)
x <- AddTip(tree, 24, edgeLength = 1, lengthBelow = 6 - 2.333553, label = "Sahelanthropus")
plot(x)
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 0.1, label = "Sahelanthropus")
plot(x)
x <- AddTip(tree, 24, edgeLength = 1, lengthBelow = 6 - 2.333553, label = "Sahelanthropus")
plot(x)
nodeIdx <- which(tree$edge[, 2] == getMRCA(tree, c("Homo_sapiens", "Neanderthal") ))
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
plot(tree)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
tree$edge.length
tree$edge
nodelabels()
tree$edge.length
0.538721 + 5.607159
0.8*0.538721 + 5.607159
0.8*(6.14588)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
for(i in 1:5){
nodeIdx <- which(tree$edge[, 2] == getMRCA(tree, c("Homo_sapiens", "Neanderthal") ))
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
}
plot(tree)
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 6-, label = "Sahelanthropus")
plot(x)
write.tree(x)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
for(i in 1:5){
nodeIdx <- which(tree$edge[, 2] == getMRCA(tree, c("Homo_sapiens", "Neanderthal") ))
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
}
plot(tree)
nodelabels()
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 6-4.916704, label = "Sahelanthropus")
plot(x)
write.tree(x)
x <- AddTip(tree, 24, edgeLength = 1, lengthBelow = 6 - 2.333553, label = "Sahelanthropus")
plot(x)
write.tree(x)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
for(i in 1:5){
nodeIdx <- which(tree$edge[, 2] == getMRCA(tree, c("Homo_sapiens", "Neanderthal") ))
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
}
plot(tree)
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 6-4.916704, label = "Sahelanthropus")
plot(x)
write.tree(x)
x <- AddTip(tree, 24, edgeLength = 1, lengthBelow = 6 - 2.333553, label = "Sahelanthropus")
plot(x)
tree$edge
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
EdgeDistances(tree)
nodelabels()
tree$edge
tree$edge.length
nodelabels()
tiplabels()
0.8 * (5.607159) + 0.568721
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 6-5.054448, label = "Sahelanthropus")
plot(x)
write.tree(x)
x <- AddTip(tree, 24, edgeLength = 1, lengthBelow = 6 - 2.333553, label = "Sahelanthropus")
plot(x)
library(ape)
library(TreeTools)
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
for(i in 1:5){
nodeIdx <- which(tree$edge[, 2] == getMRCA(tree, c("Homo_sapiens", "Neanderthal") ))
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = "fossil")
}
plot(tree)
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 6-5.054448, label = "Sahelanthropus")
plot(x)
write.tree(x)
x <- AddTip(tree, 24, edgeLength = 1, lengthBelow = 6 - 2.333553, label = "Sahelanthropus")
plot(x)
write.tree(x)
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 6-5.054448, label = "Sahelanthropus")
plot(x)
write.tree(x)
x <- AddTip(tree, 24, edgeLength = 1, lengthBelow = 6 - 2.333553, label = "Sahelanthropus")
plot(x)
write.tree(x)
install.packages(FossilSim)
install.packages("FossilSim")
tree <- read.tree(text = "(((Gorilla_beringei:2.558516,Gorilla_gorilla:2.558516):6.093717,((Homo_sapiens:0.568721,Neanderthal:0.538721):5.607159,(Pan_paniscus:2.333553,Pan_troglodytes:2.333553):3.842326):2.476353):6.480222,(Pongo_abelii:3.825854,Pongo_pygmaeus:3.825854):11.306601);")
plot(tree)
for(i in 1:5){
nodeIdx <- which(tree$edge[, 2] == getMRCA(tree, c("Homo_sapiens", "Neanderthal") ))
branch_length <- tree$edge.length[nodeIdx]
branch_length
tree <- AddTip(tree, getMRCA(tree, c("Homo_sapiens", "Neanderthal") ), edgeLength = 1, lengthBelow = 0.8 * branch_length, label = paste("fossil", i))
}
plot(tree)
x <- AddTip(tree, 18, edgeLength = 1, lengthBelow = 6-5.054448, label = "Sahelanthropus")
plot(x)
write.tree(x)
x <- AddTip(tree, 24, edgeLength = 1, lengthBelow = 6 - 2.333553, label = "Sahelanthropus")
plot(x)
write.tree(x)
concatDat <- data.table::fread("/Users/levir/Documents/GitHub/Raskin_Thesis/results/LC/hspResConcat(MP,Hs),MP),N.tsv")
res <- apply(concatDat, 2, mean)
library(ggplot2)
ggplot() + geom_density(data = as.data.frame(rbeta(10000, 2, 2)))
ggplot() + geom_density(data = as.data.frame("x" = rbeta(10000, 2, 2)))
ggplot() + geom_density(data = as.data.frame("x" = rbeta(10000, 2, 2)), aes(x=x))
ggplot() + geom_density(data = as.data.frame(x = rbeta(10000, 2, 2)), aes(x=x))
ggplot() + geom_density(data = data.frame(x = rbeta(10000, 2, 2)), aes(x=x))
ggplot() + geom_density(data = data.frame(x = rbeta(10000, 2, 2)), aes(x=x)) + theme_minimal()
ggplot() + geom_density(data = data.frame(x = rbeta(100000, 2, 2)), aes(x=x)) + theme_minimal()
ggplot() + geom_density(data = data.frame(x = rbeta(10000000, 2, 2)), aes(x=x)) + theme_minimal()
ggplot() + geom_density(data = data.frame(x = rbeta(10000000, 2, 2)), aes(x=x)) + theme_minimal() + xlab("Coin bias")
dbinom(60, 100, 0.321)
dbinom(60, 100, 0.321, log = T)
dbeta(0.321, 2, 2, log = T)
dbinom(60, 100, 0.43, log = T)
dbeta(0.43, 2, 2, log = T)
Exp( (-18.87 + 0.27) – (-8.33 + 0.39))
exp(( (-18.87 + 0.27) – (-8.33 + 0.39)))
exp((-18.87 + 0.27) - (-8.33 + 0.39))
exp((-8.33 + 0.39) - (-18.87 + 0.27) )
(-8.33 + 0.39) - (-18.87 + 0.27)
1 x 2^2 + 0  * 2^1 + 1  * 2^0 + 0  * 2^-1 + 1*2^-2
1*2^2 + 0* 2^1 + 1  * 2^0 + 0  * 2^-1 + 1*2^-2
scalar <- 1
newScalar <- scalar
newScalar <- 2
print(scalar)
print(newScalar)
list <- list()
list <- list([scalar, newScalar])
list <- list(scalar, newScalar)
View(list)
list <- list(scalar, newScalar)
print(list)
newScalar <- 3
print(newScalar)
print(list)
vec <- c(scalar, newScalar)
print(vec)
newScalar <- 2
print(vec)
scalar <- 1
newScalar <- 2
list <- list(scalar, newScalar)
.Internal(inspect(list))
list[[0]] <- 2
.Internal(inspect(list))
list[[1]] <- 2
.Internal(inspect(list))
scalar <- 1
newScalar <- 2
list <- list(scalar, newScalar)
.Internal(inspect(list))
list[[1]] <- 2
.Internal(inspect(list))
list <- list("ABC", "ABC", "ABC", "ABC")
.Internal(inspect(list))
list2 <- copy(list)
.Internal(inspect(list2))
list2 <- list
.Internal(inspect(list2))
list2[[1]] <- "twelve"
list
list2
.Internal(inspect(list2))
library(ape)
library(colorspace)
library(dplyr)
library(gghalves)
library(ggnewscale)
library(ggplot2)
library(ggrepel)
library(ggtree)
library(ggstar)
library(phangorn)
library(phytools)
library(plotly)
library(RColorBrewer)
output <- "/Users/levir/Documents/GitHub/PCAPhylogenetics/manuscript/figures/"
treeSubset <- read.delim("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/sampledTrees.tsv")
#convert to phylo object
phyloList <- list()
for(i in 1:nrow(treeSubset)){
phyloList[[i]] <- ape::read.tree(text = as.character(treeSubset[i, 2]))
}
tree <- phyloList[[1]]
tree$tip.label <- gsub("_", tree$tip.label, replacement = " ")
p1 <- ggtree(tree)+
geom_tiplab(fontface = 4)+
xlim(NA, 5)
p1 <- ggtree::rotate(p1, 36)
p1
simResPC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults.rds")
simRes2550PC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults25char50char.rds")
simRes500PC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults500char.rds")
library(plotly)
library(RColorBrewer)
library(ape)
library(colorspace)
library(dplyr)
library(gghalves)
library(ggnewscale)
library(ggplot2)
library(ggrepel)
library(ggtree)
library(ggstar)
library(phangorn)
library(phytools)
library(plotly)
library(RColorBrewer)
output <- "/Users/levir/Documents/GitHub/PCAPhylogenetics/manuscript/figures/"
treeSubset <- read.delim("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/sampledTrees.tsv")
#convert to phylo object
phyloList <- list()
for(i in 1:nrow(treeSubset)){
phyloList[[i]] <- ape::read.tree(text = as.character(treeSubset[i, 2]))
}
tree <- phyloList[[1]]
tree$tip.label <- gsub("_", tree$tip.label, replacement = " ")
simResPC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults.rds")
simRes2550PC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults25char50char.rds")
simRes500PC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults500char.rds")
simResPC1PC2 <- c(simResPC1PC2, simRes2550PC1PC2, simRes500PC1PC2)
simResPC1PC2 <- readRDS("resultsGit/simulationResults.rds")
simRes2550PC1PC2 <- readRDS("resultsGit/simulationResults25char50char.rds")
library(ape)
library(colorspace)
library(dplyr)
library(gghalves)
library(ggnewscale)
library(ggplot2)
library(ggrepel)
library(ggtree)
library(ggstar)
library(phangorn)
library(phytools)
library(plotly)
library(RColorBrewer)
setwd("/Users/levir/Documents/GitHub/PCAPhylogenetics")
output <- "manuscript/figures/"
treeSubset <- read.delim("resultsGit/sampledTrees.tsv")
#convert to phylo object
phyloList <- list()
for(i in 1:nrow(treeSubset)){
phyloList[[i]] <- ape::read.tree(text = as.character(treeSubset[i, 2]))
}
tree <- phyloList[[1]]
simResPC1PC2 <- readRDS("resultsGit/simulationResults.rds")
simRes2550PC1PC2 <- readRDS("resultsGit/simulationResults25char50char.rds")
simRes500PC1PC2 <- readRDS("resultsGit/simulationResults500char.rds")
simResPC1PC2 <- c(simResPC1PC2, simRes2550PC1PC2, simRes500PC1PC2)
for(i in 1:length(simResPC1PC2)){
if(i == 1){
concatDF <- simResPC1PC2[[1]]$resMat
}else{
concatDF <- rbind(concatDF, simResPC1PC2[[i]]$resMat)
}
if(i %% 100 == 0){
print(i)
}
}
concatDF$numCharacters <- as.factor(concatDF$numCharacters)
concatDF$setRate <- as.factor(concatDF$setRate)
concatDF$propConflicting <- as.factor(concatDF$propConflicting)
concatDF$varRateExpectation <- concatDF$variableRateShape / concatDF$variableRateScale
concatDF$varRateExpectation <- as.factor(concatDF$varRateExpectation)
