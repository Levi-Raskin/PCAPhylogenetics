# Stack vertically
stack_plot <-patchwork::wrap_plots(plots, ncol = 1)
stack_plot
ggsave(filename = paste(output, "3Dfig1LDDMMAlpha04.svg", sep = ""),
plot = stack_plot,
width = 2,
height = 42)
simResPC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults.rds")
simRes2550PC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults25char50char.rds")
simRes500PC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults500char.rds")
# Setup -------------------------------------------------------------------
library(ape)
library(dplyr)
library(ggplot2)
library(ggtree)
library(phangorn)
library(phytools)
library(tictoc)
library(data.table)
library(geomorph)
setwd("/Users/levir/Documents/GitHub/PCAPhylogenetics")
set.seed(5)
rSPRFunc <- function(tree1, tree2){
treelist <- list(tree1, tree2)
write.tree(treelist, paste(getwd(), "/rSPR/res.nwk", sep = ""))
res <- system(
paste(getwd(),
"/rSPR/rspr -pairwise -unrooted -no-symmetric-pairwise < ",
getwd(),
"/rSPR/res.nwk", sep = "")
, intern = T)
nums <- sub("^[^,]*,\\s*([0-9]+)\"?$", "\\1", res[[1]])
return(as.integer(nums))
}
rSPRFunc2 <- function(tree1, tree2){
treelist <- list(tree1, tree2)
write.tree(treelist, paste(getwd(), "/rSPR/res2.nwk", sep = ""))
res <- system(
paste(getwd(),
"/rSPR/rspr2 -pairwise -unrooted -no-symmetric-pairwise < ",
getwd(),
"/rSPR/res2.nwk", sep = "")
, intern = T)
nums <- sub("^[^,]*,\\s*([0-9]+)\"?$", "\\1", res[[1]])
return(as.integer(nums))
}
rSPRFunc3 <- function(tree1, tree2){
treelist <- list(tree1, tree2)
write.tree(treelist, paste(getwd(), "/rSPR/res3.nwk", sep = ""))
res <- system(
paste(getwd(),
"/rSPR/rspr3 -pairwise -unrooted -no-symmetric-pairwise < ",
getwd(),
"/rSPR/res3.nwk", sep = "")
, intern = T)
nums <- sub("^[^,]*,\\s*([0-9]+)\"?$", "\\1", res[[1]])
return(as.integer(nums))
}
rSPRFunc4 <- function(tree1, tree2){
treelist <- list(tree1, tree2)
write.tree(treelist, paste(getwd(), "/rSPR/res4.nwk", sep = ""))
res <- system(
paste(getwd(),
"/rSPR/rspr4 -pairwise -unrooted -no-symmetric-pairwise < ",
getwd(),
"/rSPR/res4.nwk", sep = "")
, intern = T)
nums <- sub("^[^,]*,\\s*([0-9]+)\"?$", "\\1", res[[1]])
return(as.integer(nums))
}
sprMast <- function(tree1, tree2){
sprDist <- rSPRFunc(tree1, tree2)
mastSize <- Ntip(phangorn::mast(tree1, tree2))
return(sprDist/mastSize)
}
sprMast2 <- function(tree1, tree2){
sprDist <- rSPRFunc2(tree1, tree2)
mastSize <- Ntip(phangorn::mast(tree1, tree2))
return(sprDist/mastSize)
}
#read tree trace
# trees <- data.table::fread("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/hominin.trees",
# nThread = 10)
#burn in
# trees <- trees[round(0.1 * nrow(trees)) : nrow(trees),]
# sample 1,000 trees from the posterior distribution
# treeSubset <- trees[sample(1:nrow(trees), 1000, replace = FALSE), ]
# rm(trees)
# write.csv(treeSubset,"/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/sampledTrees.csv")
treeSubset <- read.delim("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/sampledTrees.tsv")
#convert to phylo object
phyloList <- list()
for(i in 1:nrow(treeSubset)){
phyloList[[i]] <- ape::read.tree(text = as.character(treeSubset[i, 2]))
}
resPC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/lddmmPC12results.rds")
resAll <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/lddmmPCallresults.rds")
resProcPC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/lddmmProcrustesPC12results.rds")
resProcAll <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/lddmmProcrustesPCallresults.rds")
sum(resPC1PC2$RF == 0) / nrow(resPC1PC2)
sum(resPC1PC2$RF == 0)
summary(resPC1PC2$RF)
summary(resPC1PC2$SPR)
sum(resPC1PC2$RF == 0) / nrow(resPC1PC2)
sum(resPC1PC2$RF == 0)
summary(resPC1PC2$RF)
summary(resPC1PC2$SPR)
sum(resAll$RF == 0) / nrow(resAll)
sum(resAll$RF == 0)
summary(resAll$RF)
summary(resAll$SPR)
wilcox.test(filter(resPC1PC2, numLandmarks == 10)$SPR, filter(resPC1PC2, numLandmarks == 25)$SPR)
mean(filter(resPC1PC2, numLandmarks == 10)$SPR)
mean(filter(resPC1PC2, numLandmarks == 25)$SPR)
mean(filter(resPC1PC2, numLandmarks == 50)$SPR)
wilcox.test(filter(resPC1PC2, numLandmarks == 10)$SPR, filter(resPC1PC2, numLandmarks == 25)$SPR)
wilcox.test(filter(resPC1PC2, numLandmarks == 25)$SPR, filter(resPC1PC2, numLandmarks == 50)$SPR)
wilcox.test(filter(resPC1PC2, numLandmarks == 10)$SPR, filter(resPC1PC2, numLandmarks == 50)$SPR)
wilcox.test(filter(resAll, numLandmarks == 10)$SPR, filter(resAll, numLandmarks == 25)$SPR)
mean(filter(resAll, numLandmarks == 10)$SPR)
mean(filter(resAll, numLandmarks == 25)$SPR)
mean(filter(resAll, numLandmarks == 50)$SPR)
wilcox.test(filter(resAll, numLandmarks == 25)$SPR, filter(resAll, numLandmarks == 50)$SPR)
wilcox.test(filter(resAll, numLandmarks == 10)$SPR, filter(resAll, numLandmarks == 50)$SPR)
mean(filter(resPC1PC2, numLandmarks == 10)$RF)
mean(filter(resPC1PC2, numLandmarks == 25)$RF)
mean(filter(resPC1PC2, numLandmarks == 50)$RF)
wilcox.test(filter(resPC1PC2, numLandmarks == 10)$RF, filter(resPC1PC2, numLandmarks == 25)$RF)
wilcox.test(filter(resPC1PC2, numLandmarks == 25)$RF, filter(resPC1PC2, numLandmarks == 50)$RF)
wilcox.test(filter(resPC1PC2, numLandmarks == 10)$RF, filter(resPC1PC2, numLandmarks == 50)$RF)
mean(filter(resAll, numLandmarks == 10)$RF)
mean(filter(resAll, numLandmarks == 25)$RF)
mean(filter(resAll, numLandmarks == 50)$RF)
wilcox.test(filter(resAll, numLandmarks == 10)$RF, filter(resAll, numLandmarks == 25)$RF)
wilcox.test(filter(resAll, numLandmarks == 25)$RF, filter(resAll, numLandmarks == 50)$RF)
wilcox.test(filter(resAll, numLandmarks == 10)$RF, filter(resAll, numLandmarks == 50)$RF)
mean(filter(resPC1PC2, Dimension == 2)$SPR)
mean(filter(resPC1PC2, Dimension == 3)$SPR)
wilcox.test(filter(resPC1PC2, Dimension == 2)$SPR, filter(resPC1PC2, Dimension == 3)$SPR)
mean(filter(resPC1PC2, Dimension == 2)$RF)
mean(filter(resPC1PC2, Dimension == 3)$RF)
wilcox.test(filter(resPC1PC2, Dimension == 2)$RF, filter(resPC1PC2, Dimension == 3)$RF)
mean(filter(resAll, Dimension == 2)$SPR)
mean(filter(resAll, Dimension == 3)$SPR)
wilcox.test(filter(resAll, Dimension == 2)$SPR, filter(resAll, Dimension == 3)$SPR)
mean(filter(resAll, Dimension == 2)$RF)
mean(filter(resAll, Dimension == 3)$RF)
wilcox.test(filter(resAll, Dimension == 2)$RF, filter(resAll, Dimension == 3)$RF)
mean(filter(resProcPC1PC2, numLandmarks == 10)$SPR)
mean(filter(resProcPC1PC2, numLandmarks == 25)$SPR)
mean(filter(resProcPC1PC2, numLandmarks == 50)$SPR)
wilcox.test(filter(resProcPC1PC2, numLandmarks == 10)$SPR, filter(resProcPC1PC2, numLandmarks == 25)$SPR)
wilcox.test(filter(resProcPC1PC2, numLandmarks == 25)$SPR, filter(resProcPC1PC2, numLandmarks == 50)$SPR)
wilcox.test(filter(resProcPC1PC2, numLandmarks == 10)$SPR, filter(resProcPC1PC2, numLandmarks == 50)$SPR)
wilcox.test(filter(resProcAll, numLandmarks == 10)$SPR, filter(resProcAll, numLandmarks == 25)$SPR)
mean(filter(resProcAll, numLandmarks == 10)$SPR)
mean(filter(resProcAll, numLandmarks == 25)$SPR)
mean(filter(resProcAll, numLandmarks == 50)$SPR)
wilcox.test(filter(resProcAll, numLandmarks == 10)$SPR, filter(resProcAll, numLandmarks == 25)$SPR)
wilcox.test(filter(resProcAll, numLandmarks == 25)$SPR, filter(resProcAll, numLandmarks == 50)$SPR)
wilcox.test(filter(resProcAll, numLandmarks == 10)$SPR, filter(resProcAll, numLandmarks == 50)$SPR)
mean(filter(resProcPC1PC2, numLandmarks == 10)$RF)
mean(filter(resProcPC1PC2, numLandmarks == 25)$RF)
mean(filter(resProcPC1PC2, numLandmarks == 50)$RF)
wilcox.test(filter(resProcPC1PC2, numLandmarks == 10)$RF, filter(resProcPC1PC2, numLandmarks == 25)$RF)
wilcox.test(filter(resProcPC1PC2, numLandmarks == 10)$RF, filter(resProcPC1PC2, numLandmarks == 25)$RF)
wilcox.test(filter(resProcPC1PC2, numLandmarks == 25)$RF, filter(resProcPC1PC2, numLandmarks == 50)$RF)
wilcox.test(filter(resProcPC1PC2, numLandmarks == 10)$RF, filter(resProcPC1PC2, numLandmarks == 50)$RF)
wilcox.test(filter(resProcAll, numLandmarks == 10)$RF, filter(resProcAll, numLandmarks == 25)$RF)
mean(filter(resProcAll, numLandmarks == 10)$RF)
mean(filter(resProcAll, numLandmarks == 25)$RF)
mean(filter(resProcAll, numLandmarks == 50)$RF)
wilcox.test(filter(resProcAll, numLandmarks == 25)$RF, filter(resProcAll, numLandmarks == 50)$RF)
wilcox.test(filter(resProcAll, numLandmarks == 10)$RF, filter(resProcAll, numLandmarks == 50)$RF)
wilcox.test(filter(resProcPC1PC2, Dimension == 2)$SPR, filter(resProcPC1PC2, Dimension == 3)$SPR)
mean(filter(resProcPC1PC2, Dimension == 2)$SPR)
mean(filter(resProcPC1PC2, Dimension == 3)$SPR)
wilcox.test(filter(resProcPC1PC2, Dimension == 2)$SPR, filter(resProcPC1PC2, Dimension == 3)$SPR)
wilcox.test(filter(resProcAll, Dimension == 2)$SPR, filter(resProcAll, Dimension == 3)$SPR)
mean(filter(resProcAll, Dimension == 2)$SPR)
mean(filter(resProcAll, Dimension == 3)$SPR)
wilcox.test(filter(resProcPC1PC2, Dimension == 2)$RF, filter(resProcPC1PC2, Dimension == 3)$RF)
mean(filter(resProcPC1PC2, Dimension == 2)$RF)
mean(filter(resProcPC1PC2, Dimension == 3)$RF)
wilcox.test(filter(resProcAll, Dimension == 2)$RF, filter(resProcAll, Dimension == 3)$RF)
mean(filter(resProcAll, Dimension == 2)$RF)
mean(filter(resProcAll, Dimension == 3)$RF)
simResPC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults.rds")
simRes2550PC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults25char50char.rds")
simRes500PC1PC2 <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResults500char.rds")
simResPC1PC2 <- c(simResPC1PC2, simRes2550PC1PC2, simRes500PC1PC2)
for(i in 1:length(simResPC1PC2)){
if(i == 1){
concatDFPC1PC2 <- simResPC1PC2[[1]]$resMat
}else{
concatDFPC1PC2 <- rbind(concatDFPC1PC2, simResPC1PC2[[i]]$resMat)
}
if(i %% 10 == 0){
print(i)
}
}
concatDFPC1PC2$numCharacters <- as.factor(concatDFPC1PC2$numCharacters)
concatDFPC1PC2$setRate <- as.factor(concatDFPC1PC2$setRate)
concatDFPC1PC2$propConflicting <- as.factor(concatDFPC1PC2$propConflicting)
concatDFPC1PC2$varRateExpectation <- concatDFPC1PC2$variableRateShape / concatDFPC1PC2$variableRateScale
concatDFPC1PC2$varRateExpectation <- as.factor(concatDFPC1PC2$varRateExpectation)
#num trees identical
sum(concatDFPC1PC2$RF == 0) / nrow(concatDFPC1PC2)
sum(concatDFPC1PC2$RF == 0)
nrow(concatDFPC1PC2)
summary(concatDFPC1PC2$RF)
summary(concatDFPC1PC2$SPR)
for(i in unique(concatDFPC1PC2$numCharacters)){
print(paste("nc: ", i, " with ", sum(filter(concatDFPC1PC2, numCharacters==i)$RF==0)))
}
simResAll <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResultsAllPCs.rds")
simRes2550All <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResultsAllPCs25char50char.rds")
simRes500All <- readRDS("/Users/levir/Documents/GitHub/PCAPhylogenetics/results/Mongle_et_al_2023_RB/SimRes/simulationResultsAllPCs500char.rds")
simResAll <- c(simResAll, simRes2550All, simRes500All)
for(i in 1:length(simResAll)){
if(i == 1){
concatDFAll <- simResAll[[1]]$resMat
}else{
concatDFAll <- rbind(concatDFAll, simResAll[[i]]$resMat)
}
if(i %% 100 == 0){
print(i)
}
}
concatDFAll$numCharacters <- as.factor(concatDFAll$numCharacters)
concatDFAll$setRate <- as.factor(concatDFAll$setRate)
concatDFAll$propConflicting <- as.factor(concatDFAll$propConflicting)
concatDFAll$varRateExpectation <- concatDFAll$variableRateShape / concatDFAll$variableRateScale
concatDFAll$varRateExpectation <- as.factor(concatDFAll$varRateExpectation)
#are the distributions sig. different between set rate and varrate expectation across numcharacters
#spr
nc <- unique(concatDFPC1PC2$numCharacters)
varRatesLG <- TRUE
rate <- c(0.1, 1, 10)
meanDiff <- c()
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR))
if(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR) < mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR)$p.value))
print("------------------------------")
}
}
table(concatDFPC1PC2$numCharacters)
#rf
nc <- unique(concatDFPC1PC2$numCharacters)
varRatesLG <- TRUE
rate <- c(0.1, 1, 10)
meanDiff <- c()
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF))
if(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF) < mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR)$p.value))
print("------------------------------")
}
}
for(c in nc){
for(p in 2:length(pc)){
print(paste(c,"characters"))
print(paste("Mean for pc:", pc[p]))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p])$SPR))
print(paste("Mean for pc: ", pc[p-1]))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p-1])$SPR))
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p-1])$SPR)))
print("------------------------------")
}
}
nc <- unique(concatDFPC1PC2$numCharacters)
pc <- unique(concatDFPC1PC2$propConflicting)
meanDiff <- c()
for(c in nc){
for(p in 2:length(pc)){
print(paste(c,"characters"))
print(paste("Mean for pc:", pc[p]))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p])$SPR))
print(paste("Mean for pc: ", pc[p-1]))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p-1])$SPR))
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p-1])$SPR)))
print("------------------------------")
}
}
#rf
nc <- unique(concatDFPC1PC2$numCharacters)
varRatesLG <- TRUE
rate <- c(0.1, 1, 10)
meanDiff <- c()
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF))
if(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF) < mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF)$p.value))
wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF)
print("------------------------------")
}
}
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF))
if(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF) < mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF)$p.value))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$RF, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF))
print("------------------------------")
}
}
#are the distributions sig. different between set rate and varrate expectation across numcharacters
#spr
nc <- unique(concatDFPC1PC2$numCharacters)
varRatesLG <- TRUE
rate <- c(0.1, 1, 10)
meanDiff <- c()
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR))
print("Mean for var rate: ")
print(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR))
if(mean(filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR) < mean(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, setRate == r, propConflicting ==0)$SPR, filter(concatDFPC1PC2, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR)$p.value))
print("------------------------------")
}
}
#spr
nc <- unique(concatDFAll$numCharacters)
rate <- c(0.1, 1, 10)
varRatesLG <- TRUE
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFAll, numCharacters == c, setRate == r, propConflicting ==0)$SPR))
print("Mean for var rate: ")
print(mean(filter(concatDFAll, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR))
if(mean(filter(concatDFAll, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR) < mean(filter(concatDFAll, numCharacters == c, setRate == r, propConflicting ==0)$SPR)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFAll, numCharacters == c, setRate == r, propConflicting ==0)$SPR, filter(concatDFAll, numCharacters == c, varRateExpectation == r, propConflicting ==0)$SPR)$p.value))
print("------------------------------")
}
}
#RF
nc <- unique(concatDFAll$numCharacters)
rate <- c(0.1, 1, 10)
varRatesLG <- TRUE
for(c in nc){
for(r in rate){
print(paste(c,"characters for rate", r))
print("Mean for set rate: ")
print(mean(filter(concatDFAll, numCharacters == c, setRate == r, propConflicting ==0)$RF))
print("Mean for var rate: ")
print(mean(filter(concatDFAll, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF))
if(mean(filter(concatDFAll, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF) < mean(filter(concatDFAll, numCharacters == c, setRate == r, propConflicting ==0)$RF)){
varRatesLG <- FALSE
}
print(paste("p =", wilcox.test(filter(concatDFAll, numCharacters == c, setRate == r, propConflicting ==0)$RF, filter(concatDFAll, numCharacters == c, varRateExpectation == r, propConflicting ==0)$RF)$p.value))
print("------------------------------")
}
}
nc <- unique(concatDFPC1PC2$numCharacters)
pc <- unique(concatDFPC1PC2$propConflicting)
meanDiff <- c()
for(c in nc){
for(p in 2:length(pc)){
print(paste(c,"characters"))
print(paste("Mean for pc:", pc[p]))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p])$SPR))
print(paste("Mean for pc: ", pc[p-1]))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p-1])$SPR))
print(paste("p =", wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p-1])$SPR)$p.value))
print("------------------------------")
}
}
for(c in nc){
for(p in pc){
print(paste(c,"characters"))
print(paste("Mean for pc:", pc[p]))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[p])$SPR))
}
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.1])$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.25])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.1])$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.5])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.1])$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.5])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.25])$SPR))
print("------------------------------")
}
a
nc <- unique(concatDFPC1PC2$numCharacters)
pc <- unique(concatDFPC1PC2$propConflicting)
meanDiff <- c()
nc <- unique(concatDFPC1PC2$numCharacters)
pc <- unique(concatDFPC1PC2$propConflicting)
meanDiff <- c()
for(c in nc){
for(p in pc){
print(paste(c,"characters"))
print(paste("Mean for pc:", p))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==p)$SPR))
}
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.1])$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.25])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.1])$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.5])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.1])$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.5])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.25])$SPR))
print("------------------------------")
}
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0])$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==pc[0.1])$SPR))
c
for(c in nc){
for(p in pc){
print(paste(c,"characters"))
print(paste("Mean for pc:", p))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==p)$SPR))
}
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==0)$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==0.1)$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.25)$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.1)$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==0.5)$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.1])$SPR))
for(c in nc){
for(p in pc){
print(paste(c,"characters"))
print(paste("Mean for pc:", p))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==p)$SPR))
}
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==0)$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==0.1)$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.25)$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.1)$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==0.5)$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.1)$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.5)$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.25)$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0)$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.25)$SPR))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0)$SPR, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.5)$SPR))
print("------------------------------")
}
nc <- unique(concatDFAll$numCharacters)
pc <- unique(concatDFAll$propConflicting)
meanDiff <- c()
for(c in nc){
for(p in pc){
print(paste(c,"characters"))
print(paste("Mean for pc:", p))
print(mean(filter(concatDFAll, numCharacters == c, propConflicting ==p)$SPR))
}
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting ==0)$SPR, filter(concatDFAll, numCharacters == c, propConflicting ==0.1)$SPR))
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting == 0.25)$SPR, filter(concatDFAll, numCharacters == c, propConflicting == 0.1)$SPR))
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting ==0.5)$SPR, filter(concatDFAll, numCharacters == c, propConflicting == 0.1)$SPR))
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting == 0.5)$SPR, filter(concatDFAll, numCharacters == c, propConflicting == 0.25)$SPR))
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting == 0)$SPR, filter(concatDFAll, numCharacters == c, propConflicting == 0.25)$SPR))
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting == 0)$SPR, filter(concatDFAll, numCharacters == c, propConflicting == 0.5)$SPR))
print("------------------------------")
}
nc <- unique(concatDFPC1PC2$numCharacters)
pc <- unique(concatDFPC1PC2$propConflicting)
meanDiff <- c()
for(c in nc){
for(p in pc){
print(paste(c,"characters"))
print(paste("Mean for pc:", p))
print(mean(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==p)$RF))
}
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==0)$RF, filter(concatDFPC1PC2, numCharacters == c, propConflicting ==0.1)$RF))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.25)$RF, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.1)$RF))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting ==0.5)$RF, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.1)$RF))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.5)$RF, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.25)$RF))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0)$RF, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.25)$RF))
print(wilcox.test(filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0)$RF, filter(concatDFPC1PC2, numCharacters == c, propConflicting == 0.5)$RF))
print("------------------------------")
}
#RF
nc <- unique(concatDFAll$numCharacters)
pc <- unique(concatDFAll$propConflicting)
meanDiff <- c()
for(c in nc){
for(p in pc){
print(paste(c,"characters"))
print(paste("Mean for pc:", p))
print(mean(filter(concatDFAll, numCharacters == c, propConflicting ==p)$RF))
}
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting ==0)$RF, filter(concatDFAll, numCharacters == c, propConflicting ==0.1)$RF))
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting == 0.25)$RF, filter(concatDFAll, numCharacters == c, propConflicting == 0.1)$RF))
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting ==0.5)$RF, filter(concatDFAll, numCharacters == c, propConflicting == 0.1)$RF))
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting == 0.5)$RF, filter(concatDFAll, numCharacters == c, propConflicting == 0.25)$RF))
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting == 0)$RF, filter(concatDFAll, numCharacters == c, propConflicting == 0.25)$RF))
print(wilcox.test(filter(concatDFAll, numCharacters == c, propConflicting == 0)$RF, filter(concatDFAll, numCharacters == c, propConflicting == 0.5)$RF))
print("------------------------------")
}
